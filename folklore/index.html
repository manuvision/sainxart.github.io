<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bestiaire GuadeloupÃ©en â€” ManuVision</title>
<link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@400;700;900&family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,300;1,400&family=Outfit:wght@200;300;400;500;600&display=swap" rel="stylesheet">
<style>
*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

:root {
  --bg-deep: #050208;
  --bg-card: #0c0a14;
  --bg-card-hover: #110e1c;
  --purple-dark: #2a1645;
  --purple-mid: #6b3fa0;
  --purple-bright: #a855f7;
  --purple-glow: #c084fc;
  --gold: #d4a847;
  --gold-dim: #a8842f;
  --text-primary: #e8e0f0;
  --text-secondary: #9a8cb0;
  --text-dim: #6b5f80;
  --red-accent: #8b2030;
  --green-spirit: #2a6b4a;
  --teal-mythe: #2dd4bf;
  --teal-mythe-dark: #0d6b5e;
  --border: rgba(107, 63, 160, 0.15);
}

html {
  scroll-behavior: smooth;
  scrollbar-width: thin;
  scrollbar-color: var(--purple-mid) var(--bg-deep);
}

body {
  font-family: 'Outfit', sans-serif;
  background: var(--bg-deep);
  color: var(--text-primary);
  min-height: 100vh;
  overflow-x: hidden;
  position: relative;
}

body::before {
  content: '';
  position: fixed;
  inset: 0;
  background:
    radial-gradient(ellipse 80% 50% at 20% 0%, rgba(42, 22, 69, 0.4) 0%, transparent 60%),
    radial-gradient(ellipse 60% 40% at 80% 100%, rgba(139, 32, 48, 0.15) 0%, transparent 50%),
    radial-gradient(ellipse 50% 50% at 50% 50%, rgba(107, 63, 160, 0.05) 0%, transparent 70%);
  pointer-events: none;
  z-index: 0;
}

body::after {
  content: '';
  position: fixed;
  inset: 0;
  opacity: 0.03;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
  background-size: 256px;
  pointer-events: none;
  z-index: 0;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• NAVIGATION â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
nav {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: 100;
  padding: 1.2rem 2rem;
  display: flex;
  align-items: center;
  justify-content: space-between;
  backdrop-filter: blur(20px);
  background: rgba(5, 2, 8, 0.7);
  border-bottom: 1px solid var(--border);
}

nav .logo {
  font-family: 'Cinzel Decorative', serif;
  font-size: 0.85rem;
  letter-spacing: 0.15em;
  color: var(--purple-glow);
  text-decoration: none;
  text-transform: uppercase;
}

nav .back-link {
  font-size: 0.8rem;
  color: var(--text-secondary);
  text-decoration: none;
  letter-spacing: 0.08em;
  transition: color 0.3s;
}
nav .back-link:hover { color: var(--purple-glow); }

.nav-right {
  display: flex;
  align-items: center;
  gap: 0.8rem;
}

.lang-switch {
  display: inline-flex;
  align-items: center;
  gap: 0.35rem;
  font-size: 0.58rem;
  letter-spacing: 0.12em;
  color: var(--text-dim);
  text-transform: uppercase;
}

.lang-switch .lang-chip {
  opacity: 0.7;
  transition: color 0.25s ease, opacity 0.25s ease;
}

.lang-switch .lang-chip.active {
  opacity: 1;
  color: var(--text-primary);
}

.lang-toggle {
  width: 32px;
  height: 18px;
  border-radius: 999px;
  border: 1px solid var(--border);
  background: rgba(12, 10, 20, 0.9);
  position: relative;
  cursor: pointer;
  transition: border-color 0.25s ease, background 0.25s ease;
  padding: 0;
}

.lang-toggle:hover {
  border-color: var(--purple-mid);
}

.lang-toggle .thumb {
  width: 12px;
  height: 12px;
  border-radius: 50%;
  background: var(--purple-glow);
  position: absolute;
  top: 2px;
  left: 2px;
  transition: transform 0.25s ease, background 0.25s ease;
}

.lang-toggle[aria-checked="true"] .thumb {
  transform: translateX(14px);
  background: var(--gold);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• HERO â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.hero {
  position: relative;
  z-index: 1;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  padding: 6rem 2rem 4rem;
}

.hero-symbol {
  font-size: 3.5rem;
  margin-bottom: 1.5rem;
  opacity: 0.7;
  animation: float 6s ease-in-out infinite;
}

@keyframes float {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-12px); }
}

.hero h1 {
  font-family: 'Cinzel Decorative', serif;
  font-weight: 900;
  font-size: clamp(2.2rem, 6vw, 4.5rem);
  line-height: 1.15;
  letter-spacing: 0.04em;
  background: linear-gradient(135deg, var(--text-primary) 0%, var(--purple-glow) 50%, var(--gold) 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 1.2rem;
}

.hero .subtitle {
  font-family: 'Cormorant Garamond', serif;
  font-size: clamp(1.1rem, 2.5vw, 1.5rem);
  font-weight: 300;
  font-style: italic;
  color: var(--text-secondary);
  max-width: 600px;
  line-height: 1.6;
  margin-bottom: 2.5rem;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• DICE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.dice-section {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 1rem;
  margin-bottom: 2rem;
}

.dice-label {
  font-size: 0.65rem;
  letter-spacing: 0.3em;
  text-transform: uppercase;
  color: var(--text-dim);
}

.dice-wrapper {
  perspective: 600px;
  width: 72px;
  height: 72px;
  cursor: pointer;
}

.dice-cube {
  width: 72px;
  height: 72px;
  position: relative;
  transform-style: preserve-3d;
  transform: rotateX(-15deg) rotateY(20deg);
  transition: transform 0.15s ease;
}

.dice-cube.rolling {
  animation: dice-roll 1.2s cubic-bezier(0.22, 1, 0.36, 1);
}

@keyframes dice-roll {
  0% { transform: rotateX(-15deg) rotateY(20deg); }
  15% { transform: rotateX(180deg) rotateY(90deg) rotateZ(45deg); }
  30% { transform: rotateX(360deg) rotateY(270deg) rotateZ(-30deg); }
  45% { transform: rotateX(540deg) rotateY(180deg) rotateZ(90deg); }
  60% { transform: rotateX(720deg) rotateY(450deg) rotateZ(-45deg); }
  75% { transform: rotateX(900deg) rotateY(630deg) rotateZ(60deg); }
  100% { transform: rotateX(1080deg) rotateY(720deg) rotateZ(0deg); }
}

.dice-face {
  position: absolute;
  width: 72px;
  height: 72px;
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.8rem;
  background: linear-gradient(145deg, rgba(42, 22, 69, 0.9), rgba(12, 10, 20, 0.95));
  border: 1px solid rgba(168, 85, 247, 0.3);
  box-shadow: inset 0 0 20px rgba(168, 85, 247, 0.1);
  backface-visibility: visible;
}

.dice-face:nth-child(1) { transform: rotateY(0deg) translateZ(36px); }
.dice-face:nth-child(2) { transform: rotateY(180deg) translateZ(36px); }
.dice-face:nth-child(3) { transform: rotateY(90deg) translateZ(36px); }
.dice-face:nth-child(4) { transform: rotateY(-90deg) translateZ(36px); }
.dice-face:nth-child(5) { transform: rotateX(90deg) translateZ(36px); }
.dice-face:nth-child(6) { transform: rotateX(-90deg) translateZ(36px); }

.dice-wrapper:hover .dice-cube:not(.rolling) {
  transform: rotateX(-20deg) rotateY(30deg) scale(1.08);
}

.dice-wrapper:active .dice-cube:not(.rolling) {
  transform: rotateX(-10deg) rotateY(15deg) scale(0.95);
}

.dice-result {
  min-height: 28px;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.dice-result-text {
  font-family: 'Cormorant Garamond', serif;
  font-style: normal;
  font-size: 1.6rem;
  color: var(--purple-glow);
  opacity: 0;
  transform: translateY(8px);
  transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1);
  cursor: pointer;
  text-decoration: none;
}

.dice-result-text:hover {
  color: #fff;
}

.dice-result-text.visible {
  opacity: 1;
  transform: translateY(0);
}

.dice-click-hint {
  font-size: 0.6rem;
  letter-spacing: 0.2em;
  text-transform: uppercase;
  color: var(--text-dim);
  opacity: 0;
  transition: opacity 0.3s;
}

.dice-wrapper:hover ~ .dice-click-hint,
.dice-click-hint.show {
  opacity: 1;
}

.hero .scroll-hint {
  font-size: 0.7rem;
  letter-spacing: 0.25em;
  text-transform: uppercase;
  color: var(--text-dim);
  animation: pulse-down 2s ease-in-out infinite;
  margin-top: 1rem;
}

.hero .scroll-hint span {
  display: block;
  margin-top: 0.5rem;
  font-size: 1.2rem;
}

@keyframes pulse-down {
  0%, 100% { opacity: 0.4; transform: translateY(0); }
  50% { opacity: 1; transform: translateY(6px); }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SECTION HEADERS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.section-header {
  text-align: center;
  padding: 5rem 2rem 2rem;
  position: relative;
  z-index: 1;
}

.section-header .label {
  font-size: 0.65rem;
  letter-spacing: 0.35em;
  text-transform: uppercase;
  color: var(--purple-bright);
  margin-bottom: 0.8rem;
}

.section-header h2 {
  font-family: 'Cinzel Decorative', serif;
  font-weight: 700;
  font-size: clamp(1.6rem, 4vw, 2.6rem);
  color: var(--text-primary);
  letter-spacing: 0.03em;
}

.section-header .divider {
  width: 60px;
  height: 1px;
  background: linear-gradient(90deg, transparent, var(--purple-mid), transparent);
  margin: 1.2rem auto 0;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• FILTER TABS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.filter-bar {
  display: flex;
  justify-content: center;
  gap: 0.5rem;
  padding: 1rem 2rem;
  flex-wrap: wrap;
  margin-bottom: 1rem;
}

.filter-btn {
  padding: 0.5rem 1.2rem;
  border: 1px solid var(--border);
  border-radius: 100px;
  background: transparent;
  color: var(--text-secondary);
  font-family: 'Outfit', sans-serif;
  font-size: 0.78rem;
  letter-spacing: 0.06em;
  cursor: pointer;
  transition: all 0.3s ease;
}

.filter-btn:hover {
  border-color: var(--purple-mid);
  color: var(--text-primary);
}

.filter-btn.active {
  background: var(--purple-dark);
  border-color: var(--purple-bright);
  color: var(--purple-glow);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CARDS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.card {
  flex-shrink: 0;
  width: 340px;
  height: 520px;
  border-radius: 20px;
  position: relative;
  overflow: hidden;
  background: var(--bg-card);
  border: 1px solid var(--border);
  transition: transform 0.5s cubic-bezier(0.23, 1, 0.32, 1), box-shadow 0.5s ease, border-color 0.3s;
  transform-style: preserve-3d;
  perspective: 1000px;
}

.card::before {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: 20px;
  background: linear-gradient(180deg, transparent 40%, rgba(5, 2, 8, 0.95) 85%);
  z-index: 2;
  pointer-events: none;
}

.card:hover {
  transform: translateY(-8px) scale(1.02);
  box-shadow: 0 20px 60px rgba(107, 63, 160, 0.2), 0 0 80px rgba(168, 85, 247, 0.08);
  border-color: rgba(107, 63, 160, 0.35);
}

/* Highlighted card (from dice or cross-link) */
.card.highlighted {
  border-color: var(--purple-bright);
  box-shadow: 0 0 40px rgba(168, 85, 247, 0.3), 0 0 100px rgba(168, 85, 247, 0.1);
  animation: highlight-pulse 2s ease-out;
}

@keyframes highlight-pulse {
  0% { box-shadow: 0 0 0px rgba(168, 85, 247, 0), border-color: var(--border); }
  30% { box-shadow: 0 0 60px rgba(168, 85, 247, 0.5), 0 0 120px rgba(168, 85, 247, 0.2); }
  100% { box-shadow: 0 0 40px rgba(168, 85, 247, 0.3), 0 0 100px rgba(168, 85, 247, 0.1); }
}

.card-image {
  position: absolute;
  inset: 0;
  z-index: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 8rem;
  opacity: 0.15;
  filter: saturate(0.6);
  transition: opacity 0.4s, transform 0.6s ease;
}

.card:hover .card-image {
  opacity: 0.25;
  transform: scale(1.05);
}

.card-content {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: 3;
  padding: 1.8rem;
}

.card-tag {
  display: inline-block;
  font-size: 0.6rem;
  letter-spacing: 0.2em;
  text-transform: uppercase;
  color: var(--purple-bright);
  background: rgba(107, 63, 160, 0.15);
  border: 1px solid rgba(107, 63, 160, 0.25);
  padding: 0.25rem 0.65rem;
  border-radius: 100px;
  margin-bottom: 0.75rem;
}

.card-tag.lieu {
  color: var(--gold);
  background: rgba(212, 168, 71, 0.1);
  border-color: rgba(212, 168, 71, 0.25);
}

.card-tag.mythe {
  color: var(--teal-mythe);
  background: rgba(45, 212, 191, 0.1);
  border-color: rgba(45, 212, 191, 0.25);
}

.card-name {
  font-family: 'Cinzel Decorative', serif;
  font-weight: 700;
  font-size: 1.3rem;
  color: var(--text-primary);
  margin-bottom: 0.2rem;
  line-height: 1.3;
}

.card-alt-name {
  font-family: 'Cormorant Garamond', serif;
  font-style: italic;
  font-size: 0.9rem;
  color: var(--text-dim);
  margin-bottom: 0.7rem;
}

.card-description {
  font-size: 0.82rem;
  line-height: 1.6;
  color: var(--text-secondary);
  display: -webkit-box;
  -webkit-line-clamp: 4;
  -webkit-box-orient: vertical;
  overflow: hidden;
  margin-bottom: 1rem;
}

.card-link {
  display: inline-flex;
  align-items: center;
  gap: 0.4rem;
  font-size: 0.75rem;
  letter-spacing: 0.1em;
  text-transform: uppercase;
  color: var(--purple-glow);
  text-decoration: none;
  transition: gap 0.3s, color 0.3s;
}

.card-link:hover {
  gap: 0.7rem;
  color: #fff;
}

.card-link .arrow {
  transition: transform 0.3s;
}
.card-link:hover .arrow { transform: translateX(3px); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• MODAL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.modal-overlay {
  position: fixed;
  inset: 0;
  z-index: 200;
  background: rgba(5, 2, 8, 0.92);
  backdrop-filter: blur(30px);
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.4s ease;
  padding: 2rem;
}

.modal-overlay.active {
  opacity: 1;
  pointer-events: all;
}

.modal-card {
  position: relative;
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: 24px;
  max-width: 620px;
  width: 100%;
  max-height: 85vh;
  overflow-y: auto;
  padding: 2.5rem;
  transform: translateY(30px) scale(0.95);
  transition: transform 0.4s cubic-bezier(0.23, 1, 0.32, 1);
  scrollbar-width: thin;
  scrollbar-color: var(--purple-dark) transparent;
}

.modal-overlay.active .modal-card {
  transform: translateY(0) scale(1);
}

.modal-close {
  position: absolute;
  top: 1.5rem;
  right: 1.5rem;
  z-index: 10;
  background: rgba(12, 10, 20, 0.8);
  border: 1px solid var(--border);
  color: var(--text-dim);
  width: 36px;
  height: 36px;
  border-radius: 50%;
  cursor: pointer;
  font-size: 1rem;
  transition: all 0.3s;
  display: flex;
  align-items: center;
  justify-content: center;
}

.modal-close:hover {
  border-color: var(--purple-mid);
  color: var(--text-primary);
}

.modal-symbol {
  font-size: 4rem;
  margin-bottom: 1rem;
  opacity: 0.5;
}

.modal-tag {
  display: inline-block;
  font-size: 0.6rem;
  letter-spacing: 0.2em;
  text-transform: uppercase;
  color: var(--purple-bright);
  background: rgba(107, 63, 160, 0.15);
  border: 1px solid rgba(107, 63, 160, 0.25);
  padding: 0.25rem 0.65rem;
  border-radius: 100px;
  margin-bottom: 0.8rem;
}

.modal-tag.lieu {
  color: var(--gold);
  background: rgba(212, 168, 71, 0.1);
  border-color: rgba(212, 168, 71, 0.25);
}

.modal-tag.mythe {
  color: var(--teal-mythe);
  background: rgba(45, 212, 191, 0.1);
  border-color: rgba(45, 212, 191, 0.25);
}

.modal-name {
  font-family: 'Cinzel Decorative', serif;
  font-weight: 700;
  font-size: 1.8rem;
  margin-bottom: 0.3rem;
}

.modal-alt {
  font-family: 'Cormorant Garamond', serif;
  font-style: italic;
  font-size: 1.05rem;
  color: var(--text-dim);
  margin-bottom: 1.2rem;
}

.modal-description {
  font-family: 'Cormorant Garamond', serif;
  font-size: 1.1rem;
  line-height: 1.8;
  color: var(--text-secondary);
  margin-bottom: 1rem;
}

.modal-story {
  font-size: 0.88rem;
  line-height: 1.7;
  color: var(--text-dim);
  border-left: 2px solid var(--purple-dark);
  padding-left: 1.2rem;
  margin-bottom: 1.2rem;
  font-style: italic;
}

/* Cross-link tags in modal */
.modal-relations {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
  margin-bottom: 1.5rem;
}

.modal-relation-tag {
  display: inline-flex;
  align-items: center;
  gap: 0.35rem;
  padding: 0.35rem 0.8rem;
  border-radius: 100px;
  font-size: 0.72rem;
  letter-spacing: 0.04em;
  cursor: pointer;
  transition: all 0.3s;
  border: 1px solid;
  text-decoration: none;
}

.modal-relation-tag.creature-link {
  color: var(--purple-glow);
  border-color: rgba(168, 85, 247, 0.25);
  background: rgba(107, 63, 160, 0.08);
}

.modal-relation-tag.creature-link:hover {
  background: rgba(107, 63, 160, 0.2);
  border-color: var(--purple-bright);
}

.modal-relation-tag.lieu-link {
  color: var(--gold);
  border-color: rgba(212, 168, 71, 0.25);
  background: rgba(212, 168, 71, 0.06);
}

.modal-relation-tag.lieu-link:hover {
  background: rgba(212, 168, 71, 0.15);
  border-color: var(--gold);
}

.modal-relation-tag.mythe-link {
  color: var(--teal-mythe);
  border-color: rgba(45, 212, 191, 0.25);
  background: rgba(45, 212, 191, 0.08);
}

.modal-relation-tag.mythe-link:hover {
  background: rgba(45, 212, 191, 0.2);
  border-color: var(--teal-mythe);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CARD GRID â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.card-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
  gap: 1.5rem;
  padding: 2rem 2rem 4rem;
  max-width: 1200px;
  margin: 0 auto;
  position: relative;
  z-index: 1;
}

.card-grid .card {
  width: auto;
  flex-shrink: unset;
  opacity: 0;
  transform: translateY(40px);
}

.card-grid .card.revealed {
  opacity: 1;
  transform: translateY(0);
  transition: opacity 0.6s cubic-bezier(0.23, 1, 0.32, 1),
              transform 0.6s cubic-bezier(0.23, 1, 0.32, 1);
}

.card-grid .card:nth-child(3n+2).revealed { transition-delay: 0.08s; }
.card-grid .card:nth-child(3n).revealed { transition-delay: 0.16s; }

.card-grid .card.revealed:hover {
  transform: translateY(-8px) scale(1.02);
}

.grid-counter {
  text-align: center;
  font-size: 0.75rem;
  color: var(--text-dim);
  letter-spacing: 0.15em;
  padding: 0 2rem 2rem;
  position: relative;
  z-index: 1;
}

.modal-relation-label {
  font-size: 0.6rem;
  letter-spacing: 0.15em;
  text-transform: uppercase;
  color: var(--text-dim);
  margin-bottom: 0.5rem;
}

.modal-links {
  display: flex;
  gap: 0.8rem;
  flex-wrap: wrap;
}

.modal-link {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.6rem 1.2rem;
  border: 1px solid var(--border);
  border-radius: 100px;
  color: var(--text-secondary);
  text-decoration: none;
  font-size: 0.78rem;
  letter-spacing: 0.05em;
  transition: all 0.3s;
}

.modal-link:hover {
  border-color: var(--purple-bright);
  color: var(--purple-glow);
  background: rgba(107, 63, 160, 0.1);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• LIEUX SECTION â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.lieux-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 1.2rem;
  padding: 1rem 2rem 5rem;
  max-width: 1200px;
  margin: 0 auto;
  position: relative;
  z-index: 1;
}

.lieu-card {
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: 16px;
  padding: 1.5rem;
  transition: all 0.3s ease;
  cursor: pointer;
}

.lieu-card:hover {
  border-color: rgba(212, 168, 71, 0.3);
  transform: translateY(-4px);
  box-shadow: 0 12px 40px rgba(212, 168, 71, 0.08);
}

.lieu-card.highlighted {
  border-color: var(--gold);
  box-shadow: 0 0 40px rgba(212, 168, 71, 0.2), 0 0 80px rgba(212, 168, 71, 0.08);
  animation: highlight-gold-pulse 2s ease-out;
}

@keyframes highlight-gold-pulse {
  0% { box-shadow: 0 0 0px rgba(212, 168, 71, 0); }
  30% { box-shadow: 0 0 60px rgba(212, 168, 71, 0.4), 0 0 120px rgba(212, 168, 71, 0.15); }
  100% { box-shadow: 0 0 40px rgba(212, 168, 71, 0.2), 0 0 80px rgba(212, 168, 71, 0.08); }
}

.lieu-card .lieu-icon {
  font-size: 2rem;
  margin-bottom: 0.8rem;
  opacity: 0.6;
}

.lieu-card h3 {
  font-family: 'Cinzel Decorative', serif;
  font-size: 1rem;
  margin-bottom: 0.15rem;
  color: var(--gold);
}

.lieu-card .lieu-alt {
  font-family: 'Cormorant Garamond', serif;
  font-style: italic;
  font-size: 0.82rem;
  color: var(--text-dim);
  margin-bottom: 0.6rem;
}

.lieu-card p {
  font-size: 0.8rem;
  line-height: 1.6;
  color: var(--text-secondary);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• FOOTER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
footer {
  position: relative;
  z-index: 1;
  text-align: center;
  padding: 3rem 2rem;
  border-top: 1px solid var(--border);
}

footer .credit {
  font-size: 0.7rem;
  letter-spacing: 0.15em;
  text-transform: uppercase;
  color: var(--text-dim);
  margin-bottom: 0.5rem;
}

footer .credit a {
  color: var(--purple-glow);
  text-decoration: none;
}

footer .note {
  font-family: 'Cormorant Garamond', serif;
  font-style: italic;
  font-size: 0.9rem;
  color: var(--text-dim);
  max-width: 500px;
  margin: 0.5rem auto 0;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• RESPONSIVE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
@media (max-width: 768px) {
  nav { padding: 1rem 1.2rem; }
  .nav-right { gap: 0.5rem; }
  .lang-switch { font-size: 0.52rem; letter-spacing: 0.1em; }
  .lang-toggle { width: 30px; height: 16px; }
  .lang-toggle .thumb { width: 10px; height: 10px; top: 2px; left: 2px; }
  .lang-toggle[aria-checked="true"] .thumb { transform: translateX(14px); }
  .card-grid {
    grid-template-columns: 1fr;
    padding: 1.5rem 1.2rem 4rem;
    gap: 1.2rem;
  }
  .card-grid .card { height: 440px; }
  .card-grid .card:nth-child(3n+2).revealed,
  .card-grid .card:nth-child(3n).revealed { transition-delay: 0s; }
  .card-content { padding: 1.4rem; }
  .modal-card { padding: 1.8rem; }
  .modal-name { font-size: 1.4rem; }
  .lieux-grid { padding: 1rem 1.2rem 5rem; }
  .filter-bar { padding: 0.8rem 1rem; gap: 0.4rem; }
  .filter-btn { padding: 0.4rem 0.9rem; font-size: 0.72rem; }
  .dice-cube, .dice-face { width: 60px; height: 60px; }
  .dice-face { border-radius: 10px; font-size: 1.5rem; }
  .dice-face:nth-child(1) { transform: rotateY(0deg) translateZ(30px); }
  .dice-face:nth-child(2) { transform: rotateY(180deg) translateZ(30px); }
  .dice-face:nth-child(3) { transform: rotateY(90deg) translateZ(30px); }
  .dice-face:nth-child(4) { transform: rotateY(-90deg) translateZ(30px); }
  .dice-face:nth-child(5) { transform: rotateX(90deg) translateZ(30px); }
  .dice-face:nth-child(6) { transform: rotateX(-90deg) translateZ(30px); }
}

@media (max-width: 480px) {
  .card-grid .card { height: 400px; }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• ANIMATIONS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
@keyframes fade-up {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

.animate-in { animation: fade-up 0.8s cubic-bezier(0.23, 1, 0.32, 1) forwards; }
.delay-1 { animation-delay: 0.1s; }
.delay-2 { animation-delay: 0.2s; }
.delay-3 { animation-delay: 0.3s; }
.delay-4 { animation-delay: 0.4s; }
.delay-5 { animation-delay: 0.5s; }
</style>
</head>
<body>

<!-- NAV -->
<nav>
  <a href="https://manu.vision" class="back-link" id="backLink">â† manu.vision</a>
  <div class="nav-right">
    <div class="lang-switch" id="langSwitch">
      <span class="lang-chip active" id="langFr">FR</span>
      <button class="lang-toggle" id="langToggle" type="button" role="switch" aria-checked="false" aria-label="Switch language">
        <span class="thumb"></span>
      </button>
      <span class="lang-chip" id="langEn">EN</span>
    </div>
    <a class="logo" id="siteLogo">Folklore</a>
  </div>
</nav>

<!-- HERO -->
<section class="hero">
  <div class="hero-symbol animate-in">ğŸ•¯ï¸</div>
  <h1 class="animate-in delay-1" id="heroTitle">Folklore<br>Antillais</h1>
  <p class="subtitle animate-in delay-2" id="heroSubtitle">
    CrÃ©atures, esprits et lieux hantÃ©s du folklore antillais. 
    Un hÃ©ritage oral transmis de gÃ©nÃ©ration en gÃ©nÃ©ration, 
    entre peur et fascination.
  </p>

  <div class="scroll-hint animate-in delay-5" id="scrollHint">
    DÃ©couvrir les crÃ©atures
    <span>â†“</span>
  </div>

  <br/>
  <br/>
  <br/>
  
  <!-- DICE -->
  <div class="dice-section animate-in delay-3">
    <!-- <div class="dice-label">DÃ©couverte alÃ©atoire</div> -->
    <div class="dice-wrapper" id="diceWrapper" title="Lance le dÃ© !">
      <div class="dice-cube" id="diceCube">
        <div class="dice-face">ğŸ‘ </div>
        <div class="dice-face">ğŸ”¥</div>
        <div class="dice-face">ğŸŒ‘</div>
        <div class="dice-face">ğŸº</div>
        <div class="dice-face">ğŸ§œâ€â™€ï¸</div>
        <div class="dice-face">ğŸ¥š</div>
      </div>
    </div>
    <br/>
    <div class="dice-click-hint show" id="diceHintText">Clique pour lancer</div>
    <div class="dice-result">
      <a class="dice-result-text" id="diceResult" href="javascript:void(0)"></a>
    </div>
  </div>
</section>

<!-- CREATURES SECTION -->
<div class="section-header">
  <div class="label" id="chapterOneLabel">Chapitre I</div>
  <h2 id="chapterOneTitle">Les CrÃ©atures</h2>
  <div class="divider"></div>
</div>

<div class="filter-bar">
  <button class="filter-btn active" data-filter="all">Tous</button>
  <button class="filter-btn" data-filter="esprit">Esprits</button>
  <button class="filter-btn" data-filter="creature">CrÃ©atures</button>
  <button class="filter-btn" data-filter="sorcellerie">Sorcellerie</button>
  <button class="filter-btn" data-filter="figure">Figures</button>
</div>

<div class="card-grid" id="creatureGrid"></div>
<div class="grid-counter" id="gridCounter"></div>

<!-- MYTHS SECTION -->
<div class="section-header" id="mythsSection">
  <div class="label" id="chapterTwoLabel">Chapitre II</div>
  <h2 id="chapterTwoTitle">Les Mythes</h2>
  <div class="divider"></div>
</div>

<div class="card-grid" id="mythGrid"></div>
<div class="grid-counter" id="mythCounter"></div>

<!-- LIEUX SECTION -->
<div class="section-header" id="lieuxSection">
  <div class="label" id="chapterThreeLabel">Chapitre III</div>
  <h2 id="chapterThreeTitle">Lieux & Objets du Surnaturel</h2>
  <div class="divider"></div>
</div>

<div class="lieux-grid" id="lieuxGrid"></div>

<!-- FOOTER -->
<footer>
  <div class="credit" id="footerCredit">Un projet de <a href="https://manu.vision" target="_blank">ManuVision</a></div>
  <p class="note" id="footerNote">Â« Le folklore n'est pas le passÃ© â€” c'est la mÃ©moire vivante d'un peuple. Â»</p>
</footer>

<!-- MODAL -->
<div class="modal-overlay" id="modal">
  <div class="modal-card">
    <button class="modal-close" id="modalClose">âœ•</button>
    <div class="modal-symbol" id="modalSymbol"></div>
    <div class="modal-tag" id="modalTag"></div>
    <h2 class="modal-name" id="modalName"></h2>
    <p class="modal-alt" id="modalAlt"></p>
    <p class="modal-description" id="modalDesc"></p>
    <div class="modal-story" id="modalStory"></div>
    <div id="modalRelations"></div>
    <div class="modal-links" id="modalLinks"></div>
  </div>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• DATA â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const creatures = [
  {
    id: "dyables",
    name: "DyablÃ¨s",
    altName: "La Diablesse",
    category: "creature",
    symbol: "ğŸ‘ ",
    description: "Femme d'une beautÃ© envoÃ»tante qui sÃ©duit les hommes pour les mener Ã  leur perte. Elle apparaÃ®t la nuit aux carrefours, vÃªtue d'une longue robe dissimulant un pied fourchu â€” sa seule imperfection.",
    story: "On dit que si tu croises une femme trop belle la nuit, regarde ses pieds. Si l'un d'eux est un sabot, cours sans te retourner. Beaucoup d'hommes se sont perdus dans les bois pour l'avoir suivie...",
    relatedCreatures: [],
    relatedLieux: ["kwaze"],
    links: [
      { label: "Court-mÃ©trage (bientÃ´t)", url: "#", icon: "ğŸ¬" },
      { label: "Lire l'histoire", url: "#", icon: "ğŸ“–" }
    ]
  },
  {
    id: "soukounyan",
    name: "Soukounyan",
    altName: "Soucouyant",
    category: "creature",
    symbol: "ğŸ”¥",
    description: "Personne â€” souvent une vieille femme â€” qui retire sa peau la nuit, la range dans un canari, et vole sous forme de boule de feu pour sucer le sang des dormeurs.",
    story: "Pour s'en dÃ©barrasser, il faut trouver sa peau et la saler. Quand elle revient la remettre, le sel la brÃ»le et elle ne peut plus reprendre forme humaine. Si tu vois une boule de feu traverser le ciel la nuit, rentre chez toi.",
    relatedCreatures: ["volant", "lougawou"],
    relatedLieux: ["kanari"],
    links: [
      { label: "Court-mÃ©trage (bientÃ´t)", url: "#", icon: "ğŸ¬" },
      { label: "Lire l'histoire", url: "#", icon: "ğŸ“–" }
    ]
  },
  {
    id: "mofwaze",
    name: "MofwazÃ©",
    altName: "EnvoyÃ© malÃ©fique",
    category: "sorcellerie",
    symbol: "ğŸ¦‡",
    description: "ÃŠtre malÃ©fique envoyÃ© par un quimboiseur, capable de se mÃ©tamorphoser en oiseau, chien ou chat noir. C'est un sort incarnÃ©, lancÃ© contre quelqu'un pour lui nuire.",
    story: "Si un animal te suit avec insistance la nuit, ou si un oiseau inconnu frappe Ã  ta fenÃªtre sans relÃ¢che, mÃ©fie-toi : c'est peut-Ãªtre un mofwazÃ© envoyÃ© contre toi.",
    relatedCreatures: ["quimboiseur"],
    relatedLieux: [],
    links: [
      { label: "Lire l'histoire", url: "#", icon: "ğŸ“–" }
    ]
  },
  {
    id: "mankoko",
    name: "Man Koko",
    altName: "Twou a Man Koko",
    category: "creature",
    symbol: "ğŸ•³ï¸",
    description: "CrÃ©ature terrifiante des bois vivant dans un trou profond. Man Koko est le croque-mitaine guadeloupÃ©en : on menace les enfants dÃ©sobÃ©issants de les y envoyer. Le Twou a Man Koko se trouve Ã  Porte d'Enfer.",
    story: "Man Koko Ã©tait une femme qui avait fait un pacte avec le diable pour obtenir beautÃ© et richesse. En contrepartie, elle devait lui donner des Ã¢mes. Elle sÃ©duisait les hommes et les faisait tomber dans le trou. Un jour, un homme toucha sa croix au cou et reprit ses esprits au bord du gouffre. Il prÃ©vint le village, et le diable, voyant qu'elle ne pouvait plus honorer son pacte, la rÃ©cupÃ©ra dans le trou.",
    relatedCreatures: ["dyables"],
    relatedLieux: ["twou-mankoko"],
    links: [
      { label: "Court-mÃ©trage (bientÃ´t)", url: "#", icon: "ğŸ¬" },
      { label: "Lire l'histoire", url: "#", icon: "ğŸ“–" }
    ]
  },
  {
    id: "dorlis",
    name: "Dorlis",
    altName: "L'incube crÃ©ole",
    category: "esprit",
    symbol: "ğŸŒ‘",
    description: "EntitÃ© nocturne qui se glisse dans les maisons par les trous de serrure et les fentes pour paralyser les dormeurs et les violer dans leur sommeil.",
    story: "Pour se protÃ©ger du Dorlis, on place des grains de riz ou de sable devant la porte. Il est obligÃ© de les compter un par un avant d'entrer â€” et le soleil se lÃ¨ve avant qu'il n'ait fini.",
    relatedCreatures: [],
    relatedLieux: ["mezon-hante"],
    links: [
      { label: "Lire l'histoire", url: "#", icon: "ğŸ“–" }
    ]
  },
  {
    id: "volant",
    name: "Volant",
    altName: "Esprit volant",
    category: "esprit",
    symbol: "âœ¨",
    description: "ÃŠtre volant nocturne associÃ© Ã  la sorcellerie. Il se dÃ©place sous forme lumineuse dans le ciel, souvent confondu avec le soukounyan mais distinct dans la tradition orale.",
    story: "Les anciens disent que quand tu vois une lumiÃ¨re se dÃ©placer dans le ciel sans bruit, ce n'est ni un avion ni une Ã©toile filante â€” c'est un volant en mission.",
    relatedCreatures: ["soukounyan"],
    relatedLieux: [],
    links: [
      { label: "Lire l'histoire", url: "#", icon: "ğŸ“–" }
    ]
  },
  {
    id: "lougawou",
    name: "Lougawou",
    altName: "Loup-garou",
    category: "creature",
    symbol: "ğŸº",
    description: "Lycanthrope antillais qui se transforme la nuit en animal â€” chien, bÅ“uf ou cochon. Parfois confondu avec le soukounyan, mais le lougawou garde une enveloppe animale complÃ¨te.",
    story: "On raconte que certaines personnes dans le village menaient une double vie. Le jour, des voisins ordinaires. La nuit, des bÃªtes rÃ´dant dans les rues sombres.",
    relatedCreatures: ["soukounyan"],
    relatedLieux: ["kwaze"],
    links: [
      { label: "Court-mÃ©trage (bientÃ´t)", url: "#", icon: "ğŸ¬" }
    ]
  },
  {
    id: "manmandlo",
    name: "Manman Dlo",
    altName: "Maman de l'Eau",
    category: "esprit",
    symbol: "ğŸ§œâ€â™€ï¸",
    description: "Esprit fÃ©minin des eaux, sirÃ¨ne crÃ©ole d'une grande beautÃ© habitant les riviÃ¨res, les bassins et la mer. Elle peut noyer ceux qui s'aventurent trop prÃ¨s de son domaine.",
    story: "Les pÃªcheurs le savent : certains bassins sont interdits. Si l'eau est trop calme, trop belle, trop invitante â€” c'est que Manman Dlo t'attend dessous.",
    relatedCreatures: ["papadlo"],
    relatedLieux: ["je-dlo"],
    links: [
      { label: "Court-mÃ©trage (bientÃ´t)", url: "#", icon: "ğŸ¬" },
      { label: "Lire l'histoire", url: "#", icon: "ğŸ“–" }
    ]
  },
  {
    id: "papadlo",
    name: "Papa Dlo",
    altName: "Esprit masculin des eaux",
    category: "esprit",
    symbol: "ğŸ",
    description: "Esprit masculin des eaux, souvent reprÃ©sentÃ© mi-homme mi-serpent. Gardien des riviÃ¨res et des sources, il punit ceux qui manquent de respect Ã  la nature.",
    story: null,
    relatedCreatures: ["manmandlo"],
    relatedLieux: ["je-dlo"],
    links: [
      { label: "Lire l'histoire", url: "#", icon: "ğŸ“–" }
    ]
  },
  {
    id: "zombi",
    name: "Zombi",
    altName: "Mort-vivant / Esprit errant",
    category: "sorcellerie",
    symbol: "âš°ï¸",
    description: "Mort rÃ©animÃ© par un quimboiseur pour en faire son esclave, ou esprit errant d'un dÃ©funt qui n'a pas trouvÃ© le repos. On distingue le zombi-cadavre du zombi-esprit.",
    story: "Le zombi antillais n'est pas celui d'Hollywood. C'est une personne dont l'Ã¢me a Ã©tÃ© volÃ©e par un sorcier, condamnÃ©e Ã  errer ou Ã  servir. C'est l'une des peurs les plus profondes du folklore.",
    relatedCreatures: ["quimboiseur", "anlespwi"],
    relatedLieux: [],
    links: [
      { label: "Lire l'histoire", url: "#", icon: "ğŸ“–" }
    ]
  },
  {
    id: "chouvaltwa",
    name: "Chouval Twa Pat",
    altName: "Cheval Ã  trois pattes",
    category: "creature",
    symbol: "ğŸ´",
    description: "Cheval fantomatique Ã  trois pattes qui apparaÃ®t la nuit aux carrefours. Le croiser est un prÃ©sage de mort ou de grand malheur.",
    story: "Tu entends le bruit de sabots, mais le rythme est faux â€” trois temps au lieu de quatre. Ne regarde pas. Ne t'arrÃªte pas. Continue ton chemin.",
    relatedCreatures: ["dyables"],
    relatedLieux: ["kwaze"],
    links: [
      { label: "Court-mÃ©trage (bientÃ´t)", url: "#", icon: "ğŸ¬" }
    ]
  },
  {
    id: "tibolom",
    name: "Ti Bolom",
    altName: "Esprit d'enfant non baptisÃ©",
    category: "esprit",
    symbol: "ğŸ‘¶",
    description: "Esprit d'un enfant mort sans baptÃªme. ApparaÃ®t sous forme d'un petit Ãªtre nu et rachitique qui pleure la nuit. ParticuliÃ¨rement redoutÃ©.",
    story: "Les pleurs d'un ti bolom ne ressemblent Ã  rien d'autre. Si tu les entends dans la nuit, prie et ne sors pas. Il cherche quelqu'un pour l'emmener de l'autre cÃ´tÃ©.",
    relatedCreatures: ["anlespwi"],
    relatedLieux: [],
    links: [
      { label: "Lire l'histoire", url: "#", icon: "ğŸ“–" }
    ]
  },
  {
    id: "tijean",
    name: "Ti Jean",
    altName: "Le trickster crÃ©ole",
    category: "figure",
    symbol: "ğŸ­",
    description: "Figure de trickster des contes crÃ©oles. Petit mais rusÃ©, Ti Jean triomphe toujours des plus forts par l'intelligence et la ruse. HÃ©ros populaire du conte oral antillais.",
    story: "Â« Est-ce que la cour dort ? Â» â€” Â« Non, la cour ne dort pas ! Â» C'est ainsi que commencent les contes de Ti Jean, Ã  la veillÃ©e, sous les Ã©toiles.",
    relatedCreatures: [],
    relatedLieux: [],
    links: [
      { label: "Lire les contes", url: "#", icon: "ğŸ“–" }
    ]
  },
  {
    id: "betamanibe",
    name: "La BÃ¨t a Man IbÃ¨",
    altName: "CrÃ©ature lÃ©gendaire",
    category: "mythe",
    symbol: "ğŸ‘¹",
    description: "CrÃ©ature monstrueuse liÃ©e Ã  un lieu prÃ©cis, utilisÃ©e dans les rÃ©cits pour effrayer. Son nom seul suffit Ã  faire taire les enfants la nuit.",
    story: null,
    relatedCreatures: [],
    relatedLieux: [],
    links: [
      { label: "Lire l'histoire", url: "#", icon: "ğŸ“–" }
    ]
  },
  {
    id: "gadedzafe",
    name: "GadÃ¨dzafÃ¨",
    altName: "Voyant / GuÃ©risseur",
    category: "sorcellerie",
    symbol: "ğŸ‘ï¸",
    description: "Voyant capable de diagnostiquer les maux surnaturels, de voir les esprits et de dÃ©faire les sorts. Figure centrale de la mÃ©decine traditionnelle guadeloupÃ©enne.",
    story: "Quand la mÃ©decine ne peut rien, quand les malheurs s'enchaÃ®nent sans explication, c'est chez le gadÃ¨dzafÃ¨ qu'on va chercher des rÃ©ponses. Il voit ce que les autres ne voient pas.",
    relatedCreatures: ["quimboiseur", "mofwaze"],
    relatedLieux: ["je-dlo"],
    links: [
      { label: "Lire l'histoire", url: "#", icon: "ğŸ“–" }
    ]
  },
  {
    id: "quimboiseur",
    name: "Quimboiseur",
    altName: "TjenbwazÃ¨ â€” Sorcier crÃ©ole",
    category: "sorcellerie",
    symbol: "ğŸ§¿",
    description: "Sorcier ou guÃ©risseur pratiquant le quimbois (magie crÃ©ole). Peut Ãªtre bienveillant â€” guÃ©risseur, leveur de sorts â€” ou malÃ©fique â€” jeteur de sorts, envoyeur de mofwazÃ©.",
    story: "Le quimboiseur connaÃ®t les plantes, les priÃ¨res, les forces invisibles. On ne prononce pas son nom Ã  la lÃ©gÃ¨re. On va le voir en secret, la nuit, par les chemins dÃ©tournÃ©s.",
    relatedCreatures: ["mofwaze", "gadedzafe", "zombi", "makanda"],
    relatedLieux: ["kwaze", "pye-bwa", "je-dlo"],
    links: [
      { label: "Lire l'histoire", url: "#", icon: "ğŸ“–" }
    ]
  },
  {
    id: "betafe",
    name: "BÃ¨t a FÃ©",
    altName: "LumiÃ¨re surnaturelle",
    category: "esprit",
    symbol: "ğŸ’«",
    description: "LumiÃ¨re surnaturelle errante dans la nuit, manifestation d'un esprit ou d'une Ã¢me en peine cherchant le repos.",
    story: null,
    relatedCreatures: ["volant", "anlespwi"],
    relatedLieux: [],
    links: [
      { label: "Lire l'histoire", url: "#", icon: "ğŸ“–" }
    ]
  },
  {
    id: "tisapoti",
    name: "Ti Sapoti Bwa",
    altName: "Esprit farceur de la forÃªt",
    category: "esprit",
    symbol: "ğŸŒ¿",
    description: "Petit esprit farceur vivant dans les bois. Il dÃ©soriente les marcheurs, cache les objets et joue des tours Ã  ceux qui s'aventurent trop profond dans la forÃªt.",
    story: "Si tu te perds en forÃªt alors que tu connais le chemin par cÅ“ur, c'est que Ti Sapoti bwa s'amuse avec toi. Retourne ton chapeau et tes poches â€” Ã§a le perturbe.",
    relatedCreatures: [],
    relatedLieux: ["pye-bwa", "fromager"],
    links: [
      { label: "Lire l'histoire", url: "#", icon: "ğŸ“–" }
    ]
  },
  {
    id: "betakon",
    name: "BÃ¨t Ã  KÃ²n",
    altName: "BÃªte Ã  cornes",
    category: "creature",
    symbol: "ğŸ‚",
    description: "CrÃ©ature cornue terrifiante aperÃ§ue la nuit, liÃ©e aux forces obscures et Ã  la sorcellerie. Son apparition est un signe de danger imminent.",
    story: null,
    relatedCreatures: ["lougawou"],
    relatedLieux: ["kwaze"],
    links: [
      { label: "Lire l'histoire", url: "#", icon: "ğŸ“–" }
    ]
  },
  {
    id: "makanda",
    name: "Makanda",
    altName: "Sort / MalÃ©fice",
    category: "sorcellerie",
    symbol: "â›“ï¸",
    description: "Sort puissant ou malÃ©fice jetÃ© par un quimboiseur. Le terme dÃ©signe Ã  la fois le sort lui-mÃªme et la pratique. Le nom viendrait de Makandal, cÃ©lÃ¨bre empoisonneur de Saint-Domingue.",
    story: "Quand quelqu'un dit Â« yo mÃ©tÃ© an makanda anlÃ¨'y Â», c'est qu'un sort a Ã©tÃ© jetÃ©. Pour le lever, il faut consulter un gadÃ¨dzafÃ¨ ou un quimboiseur plus puissant que celui qui l'a lancÃ©.",
    relatedCreatures: ["quimboiseur", "gadedzafe"],
    relatedLieux: [],
    links: [
      { label: "Lire l'histoire", url: "#", icon: "ğŸ“–" }
    ]
  },
  {
    id: "anlespwi",
    name: "An LÃ¨spwi",
    altName: "Esprits errants / Revenants",
    category: "esprit",
    symbol: "ğŸ‘»",
    description: "Esprits errants de dÃ©funts n'ayant pas trouvÃ© le repos. Ils hantent les lieux de leur mort ou de leur vie, parfois pour transmettre un message, parfois par malveillance.",
    story: "Les anciens laissent toujours un verre d'eau Ã  la porte pour les lÃ¨spwi assoiffÃ©s. Un esprit apaisÃ© laisse tranquille. Un esprit nÃ©gligÃ© revient.",
    relatedCreatures: ["tibolom", "bolomsantet"],
    relatedLieux: ["mezon-hante", "tchenn"],
    links: [
      { label: "Lire l'histoire", url: "#", icon: "ğŸ“–" }
    ]
  },
  {
    id: "fanmanblan",
    name: "Fanm an Blan",
    altName: "La dame blanche crÃ©ole",
    category: "esprit",
    symbol: "ğŸ¤",
    description: "Apparition spectrale d'une femme en blanc, souvent aperÃ§ue au bord des routes la nuit ou prÃ¨s des cimetiÃ¨res. Version crÃ©ole de la dame blanche.",
    story: null,
    relatedCreatures: ["anlespwi", "dyables"],
    relatedLieux: ["kwaze"],
    links: [
      { label: "Lire l'histoire", url: "#", icon: "ğŸ“–" }
    ]
  },
  {
    id: "bolomsantet",
    name: "Bolom San TÃ¨t",
    altName: "FantÃ´me sans tÃªte",
    category: "esprit",
    symbol: "ğŸ’€",
    description: "FantÃ´me sans tÃªte errant la nuit. Figure terrifiante du folklore liÃ©e aux victimes d'exÃ©cution ou de violence pendant l'esclavage.",
    story: null,
    relatedCreatures: ["anlespwi"],
    relatedLieux: ["tchenn"],
    links: [
      { label: "Lire l'histoire", url: "#", icon: "ğŸ“–" }
    ]
  },
  {
    id: "bebedyab",
    name: "BÃ©bÃ© Dyab",
    altName: "Le bÃ©bÃ© diable / Tilous en Martinique",
    category: "sorcellerie",
    symbol: "ğŸ¥š",
    description: "Petit monstre nÃ© d'un rituel : on couve un Å“uf sous son bras pendant un nombre de jours prÃ©cis. La crÃ©ature qui en sort exauce tous tes souhaits â€” richesse, succÃ¨s â€” mais il faut la nourrir. Chaque jour, elle demande le double de la veille.",
    story: "Quand tu n'arrives plus Ã  le nourrir, le bÃ©bÃ© dyab se nourrit des gens autour de toi â€” tes amis, ta sÅ“ur, ton frÃ¨re. Pour l'Ã©liminer, tu dois l'emmener en mer et le jeter dans l'eau sans te retourner. Mais il prend la voix de tes proches pour te rappeler : Â« Viens me chercher, je me noie ! Â» Si tu te retournes, il te mange.",
    relatedCreatures: ["quimboiseur"],
    relatedLieux: [],
    links: [
      { label: "Court-mÃ©trage (bientÃ´t)", url: "#", icon: "ğŸ¬" },
      { label: "Lire l'histoire", url: "#", icon: "ğŸ“–" }
    ]
  },
  {
    id: "sese",
    name: "ğŸŒ™ Le Mythe de SÃ©sÃ©",
    altName: "Mythe fondateur Kalinago â€” L'origine de la Lune et du Colibri",
    category: "mythe",
    symbol: "ğŸŒ™",
    description: "Mythe fondateur amÃ©rindien racontant l'histoire de SÃ©sÃ©, une jeune fille Kalinago. Dans une version, son frÃ¨re est chassÃ© du village et devient la Lune ; un oiseau porte l'enfant de SÃ©sÃ© jusqu'aux cieux, et la Lune lui offre ses couleurs â€” c'est le Colibri. Dans la seconde version, SÃ©sÃ© prend pour amant un grand serpent de la riviÃ¨re. Quand son frÃ¨re le tue, elle enterre les morceaux. De la terre naissent des enfants qui se sÃ©parent en deux villages â€” l'origine de la sÃ©paration entre Arawaks et Kalinagos. On dit que lorsque la CaraÃ¯be sera rÃ©unie, le serpent â€” l'arc antillais â€” retrouvera sa puissance.",
    story: "Version 1 â€” Le frÃ¨re de SÃ©sÃ© lui rendait visite dans son hamac, la nuit, en secret. Pour dÃ©couvrir son identitÃ©, elle lui enduisit le visage de gÃ©nipa. Au matin, les marques trahirent le frÃ¨re. Banni du village, il s'enfuit vers le ciel et devint la Lune â€” et les taches qu'on y voit sont les traces de gÃ©nipa. SÃ©sÃ©, enceinte, donna naissance Ã  un enfant. Un colibri porta le bÃ©bÃ© jusqu'Ã  la Lune, qui lui offrit ses couleurs iridescentes en remerciement.\n\nVersion 2 â€” SÃ©sÃ© dÃ©couvrit une riviÃ¨re interdite au fond de la forÃªt. Un grand serpent y vivait et devint son amant. Chaque jour elle allait le retrouver, prÃ©textant cueillir des fruits. Son frÃ¨re, soupÃ§onneux, la suivit et tua le serpent. SÃ©sÃ©, dÃ©vastÃ©e, enterra les morceaux du corps. De chaque morceau naquit un enfant. Les enfants se sÃ©parÃ¨rent en deux groupes qui fondÃ¨rent deux villages â€” les Arawaks et les Kalinagos. La prophÃ©tie dit que le jour oÃ¹ les peuples de la CaraÃ¯be seront rÃ©unis, le serpent â€” l'arc des Antilles â€” retrouvera toute sa puissance.",
    relatedCreatures: ["papadlo"],
    relatedLieux: ["pye-bwa", "je-dlo"],
    links: [
      { label: "Lire l'histoire", url: "#", icon: "ğŸ“–" }
    ]
  }
];

const lieux = [
  {
    id: "fromager",
    name: "Fromager",
    altName: "Mapou",
    icon: "ğŸŒ³",
    description: "Arbre sacrÃ© et redoutÃ©, considÃ©rÃ© comme demeure des esprits. On ne le coupe jamais sans prÃ©cautions rituelles. Le fromager est le seuil entre les mondes.",
    relatedCreatures: ["tisapoti", "anlespwi", "quimboiseur"],
    category: "lieu"
  },
  {
    id: "kwaze",
    name: "KwazÃ©",
    altName: "Carrefour",
    icon: "âœï¸",
    description: "Lieu de rencontre entre le monde des vivants et celui des esprits. C'est lÃ  qu'on dÃ©pose les travaux de quimbois et qu'apparaissent la DyablÃ¨s et le Chouval twa pat.",
    relatedCreatures: ["dyables", "chouvaltwa", "lougawou", "quimboiseur"],
    category: "lieu"
  },
  {
    id: "kanari",
    name: "Kanari",
    altName: "Jarre en terre cuite",
    icon: "ğŸº",
    description: "RÃ©cipient dans lequel le soukounyan range sa peau avant de s'envoler. Trouver le kanari et saler la peau, c'est le seul moyen de le vaincre.",
    relatedCreatures: ["soukounyan"],
    category: "lieu"
  },
  {
    id: "mezon-hante",
    name: "MÃ¨zon HantÃ©",
    altName: "Maison hantÃ©e",
    icon: "ğŸšï¸",
    description: "Maisons habitÃ©es par des esprits, souvent liÃ©es Ã  un drame passÃ© ou Ã  un trÃ©sor enterrÃ©. Chaque quartier en Guadeloupe a la sienne.",
    relatedCreatures: ["anlespwi", "dorlis"],
    category: "lieu"
  },
  {
    id: "tchenn",
    name: "Tchenn",
    altName: "ChaÃ®nes",
    icon: "â›“ï¸",
    description: "Bruit de chaÃ®nes traÃ®nÃ©es la nuit, signe de la prÃ©sence d'esprits tourmentÃ©s â€” souvent liÃ©s Ã  la mÃ©moire de l'esclavage.",
    relatedCreatures: ["anlespwi", "bolomsantet"],
    category: "lieu"
  },
  {
    id: "je-dlo",
    name: "JÃ© Dlo",
    altName: "Bains rituels",
    icon: "ğŸ’§",
    description: "Purifications par l'eau et les plantes pour se protÃ©ger des entitÃ©s malÃ©fiques ou lever un sort. Pratique centrale de la mÃ©decine traditionnelle.",
    relatedCreatures: ["gadedzafe", "quimboiseur", "manmandlo"],
    category: "lieu"
  },
  {
    id: "pye-bwa",
    name: "PyÃ© Bwa",
    altName: "Arbres habitÃ©s",
    icon: "ğŸŒ´",
    description: "Certains arbres â€” le fromager, le figuier maudit â€” sont considÃ©rÃ©s comme habitÃ©s par des esprits. On ne s'y adosse pas la nuit.",
    relatedCreatures: ["tisapoti", "quimboiseur"],
    category: "lieu"
  },
  {
    id: "twou-mankoko",
    name: "Twou a Man Koko",
    altName: "Porte d'Enfer, Anse-Bertrand",
    icon: "ğŸ•³ï¸",
    description: "Le gouffre de Porte d'Enfer, considÃ©rÃ© comme une des portes vers les enfers. C'est lÃ  que Man Koko faisait tomber les hommes sÃ©duits par sa beautÃ©.",
    relatedCreatures: ["mankoko", "dyables"],
    category: "lieu"
  }
];

const creatureEntries = creatures.filter(c => c.category !== 'mythe');
const myths = creatures.filter(c => c.category === 'mythe');

const i18n = {
  fr: {
    pageTitle: "Bestiaire GuadeloupÃ©en â€” ManuVision",
    heroTitle: "Folklore<br>Antillais",
    heroSubtitle: "CrÃ©atures, esprits et lieux hantÃ©s du folklore antillais. Un hÃ©ritage oral transmis de gÃ©nÃ©ration en gÃ©nÃ©ration, entre peur et fascination.",
    scrollHint: "DÃ©couvrir les crÃ©atures",
    diceTitle: "Lance le dÃ© !",
    diceHintIdle: "Clique pour lancer",
    diceHintAfter: "Clique le nom pour dÃ©couvrir",
    chapterOneLabel: "Chapitre I",
    chapterOneTitle: "Les CrÃ©atures",
    chapterTwoLabel: "Chapitre II",
    chapterTwoTitle: "Les Mythes",
    chapterThreeLabel: "Chapitre III",
    chapterThreeTitle: "Lieux & Objets du Surnaturel",
    filterAll: "Tous",
    filterEsprit: "Esprits",
    filterCreature: "CrÃ©atures",
    filterSorcellerie: "Sorcellerie",
    filterFigure: "Figures",
    discover: "DÃ©couvrir",
    connections: "Connexions",
    counterEntryOne: "entrÃ©e",
    counterEntryMany: "entrÃ©es",
    counterMythOne: "mythe",
    counterMythMany: "mythes",
    footerCredit: "Un projet de <a href=\"https://manu.vision\" target=\"_blank\">ManuVision</a>",
    footerNote: "Â« Le folklore n'est pas le passÃ© â€” c'est la mÃ©moire vivante d'un peuple. Â»",
    categories: { esprit: "Esprit", creature: "CrÃ©ature", sorcellerie: "Sorcellerie", figure: "Figure", lieu: "Lieu", mythe: "Mythe" },
    linkLabels: {
      "Court-mÃ©trage (bientÃ´t)": "Court-mÃ©trage (bientÃ´t)",
      "Lire l'histoire": "Lire l'histoire",
      "Lire les contes": "Lire les contes"
    }
  },
  en: {
    pageTitle: "Guadeloupean Bestiary â€” ManuVision",
    heroTitle: "Caribbean<br>Folklore",
    heroSubtitle: "Creatures, spirits, and haunted places from Caribbean folklore. A living oral heritage passed down across generations, between fear and fascination.",
    scrollHint: "Discover the creatures",
    diceTitle: "Roll the die!",
    diceHintIdle: "Click to roll",
    diceHintAfter: "Click the name to discover",
    chapterOneLabel: "Chapter I",
    chapterOneTitle: "Creatures",
    chapterTwoLabel: "Chapter II",
    chapterTwoTitle: "Myths",
    chapterThreeLabel: "Chapter III",
    chapterThreeTitle: "Places & Supernatural Objects",
    filterAll: "All",
    filterEsprit: "Spirits",
    filterCreature: "Creatures",
    filterSorcellerie: "Witchcraft",
    filterFigure: "Figures",
    discover: "Discover",
    connections: "Connections",
    counterEntryOne: "entry",
    counterEntryMany: "entries",
    counterMythOne: "myth",
    counterMythMany: "myths",
    footerCredit: "A project by <a href=\"https://manu.vision\" target=\"_blank\">ManuVision</a>",
    footerNote: "â€œFolklore is not the past â€” it is the living memory of a people.â€",
    categories: { esprit: "Spirit", creature: "Creature", sorcellerie: "Witchcraft", figure: "Figure", lieu: "Place", mythe: "Myth" },
    linkLabels: {
      "Court-mÃ©trage (bientÃ´t)": "Short film (coming soon)",
      "Lire l'histoire": "Read the story",
      "Lire les contes": "Read the tales"
    }
  }
};

const entryTranslations = {
  en: {
    dyables: {
      altName: "The Diablesse",
      description: "A bewitching woman who seduces men and leads them to ruin. She appears at night at crossroads, wearing a long dress that hides a cloven hoof.",
      story: "If you meet a woman who seems too beautiful at night, look at her feet. If one is a hoof, run and do not look back. Many men have vanished into the woods after following her."
    },
    soukounyan: {
      description: "A person, often an old woman, who removes her skin at night, stores it in a clay jar, and flies as a ball of fire to feed on sleeping people.",
      story: "To stop her, you must find the skin and salt it. When she returns to put it back on, the salt burns her and she cannot become human again. If you see a fireball crossing the night sky, go home."
    },
    mofwaze: {
      altName: "Malevolent sender",
      description: "A harmful being sent by a quimboiseur, able to transform into a bird, dog, or black cat. It is an embodied curse sent to hurt someone.",
      story: "If an animal keeps following you at night, or a strange bird keeps striking your window, beware: it may be a mofwaze sent against you."
    },
    mankoko: {
      description: "A terrifying forest creature living in a deep hole. Man Koko is Guadeloupe's bogey figure used to frighten disobedient children.",
      story: "Man Koko was said to be a woman who made a pact with the devil for beauty and wealth. In return she had to deliver souls, luring men to the abyss."
    },
    dorlis: {
      altName: "The Creole incubus",
      description: "A night entity that slips into homes through keyholes and cracks, paralyzing sleepers and assaulting them in their sleep.",
      story: "People place rice or sand at the door. Dorlis must count every grain before entering, and dawn comes before he can finish."
    },
    volant: {
      altName: "Flying spirit",
      description: "A nocturnal flying being associated with witchcraft, seen as a moving light in the sky.",
      story: "Elders say that a silent light moving in the sky is not a plane or a shooting star. It is a volant on a mission."
    },
    lougawou: {
      altName: "Werewolf",
      description: "A Caribbean lycanthrope that transforms at night into an animal such as a dog, ox, or pig.",
      story: "Some people were said to live two lives: ordinary neighbors by day, prowling beasts at night."
    },
    manmandlo: {
      altName: "Mother of Water",
      description: "A female water spirit, a Creole mermaid of great beauty living in rivers, pools, and the sea.",
      story: "Fishermen know some pools are forbidden. If water looks too calm and too inviting, Manman Dlo may be waiting below."
    },
    papadlo: {
      altName: "Male spirit of the waters",
      description: "A male water spirit, often half-man half-serpent, guardian of rivers and springs.",
      story: null
    },
    zombi: {
      altName: "Undead / wandering spirit",
      description: "A dead person reanimated by a quimboiseur as a servant, or a restless spirit of the dead.",
      story: "The Caribbean zombi is not Hollywood's zombie. It is a person whose soul has been stolen by sorcery."
    },
    chouvaltwa: {
      altName: "Three-legged horse",
      description: "A ghostly three-legged horse that appears at crossroads at night, seen as an omen of death or disaster.",
      story: "You hear hoofbeats, but the rhythm is wrong: three beats instead of four. Do not stop. Keep walking."
    },
    tibolom: {
      altName: "Spirit of an unbaptized child",
      description: "The spirit of a child who died unbaptized, appearing as a small frail being crying in the night.",
      story: "If you hear the cry of a ti bolom at night, pray and stay inside."
    },
    tijean: {
      altName: "The Creole trickster",
      description: "A trickster figure from Creole tales. Small but clever, Ti Jean defeats the strong through wit.",
      story: "â€œIs the courtyard asleep?â€ â€” â€œNo, the courtyard is not asleep!â€ This is how Ti Jean stories begin during night gatherings."
    },
    betamanibe: {
      altName: "Legendary beast",
      description: "A monstrous creature tied to a specific place, used in tales to scare people.",
      story: null
    },
    gadedzafe: {
      altName: "Seer / Healer",
      description: "A seer able to diagnose supernatural harm, perceive spirits, and break curses.",
      story: "When medicine has no answer and misfortune keeps coming, people seek a gadedzafe."
    },
    quimboiseur: {
      altName: "Creole sorcerer-healer",
      description: "A practitioner of quimbois (Creole magic), sometimes benevolent and sometimes harmful.",
      story: "A quimboiseur knows plants, prayers, and unseen forces. People consult one discreetly."
    },
    betafe: {
      altName: "Supernatural light",
      description: "A wandering supernatural light in the night, seen as a spirit manifestation.",
      story: null
    },
    tisapoti: {
      altName: "Mischievous forest spirit",
      description: "A small prankster spirit of the woods that disorients walkers and hides objects.",
      story: "If you get lost in a forest you know well, Ti Sapoti Bwa may be toying with you."
    },
    betakon: {
      altName: "Horned beast",
      description: "A terrifying horned creature seen at night and linked to dark forces and witchcraft.",
      story: null
    },
    makanda: {
      altName: "Curse / spell",
      description: "A powerful curse cast by a quimboiseur.",
      story: "When people say someone has been struck by a makanda, they seek a stronger healer to lift it."
    },
    anlespwi: {
      altName: "Wandering spirits / revenants",
      description: "Restless spirits of the dead who have not found peace.",
      story: "Elders leave a glass of water at the door for thirsty spirits. A soothed spirit leaves you in peace."
    },
    fanmanblan: {
      altName: "The Creole white lady",
      description: "A spectral woman in white often seen on roads at night or near graveyards.",
      story: null
    },
    bolomsantet: {
      altName: "Headless ghost",
      description: "A headless ghost roaming at night, tied to violent memories from slavery times.",
      story: null
    },
    bebedyab: {
      altName: "Devil baby / Tilous in Martinique",
      description: "A small monster born from a ritual egg incubation, granting wishes but demanding ever-increasing food.",
      story: "When you can no longer feed it, it feeds on people around you. To get rid of it, throw it into the sea without looking back."
    },
    sese: {
      name: "ğŸŒ™ The Myth of Sese",
      altName: "Kalinago founding myth â€” origin of the Moon and the Hummingbird",
      description: "An Indigenous founding myth about Sese, a young Kalinago girl, linking the Moon, the hummingbird, and the separation of peoples.",
      story: "Version 1: Sese marks her secret night visitor with genipa and discovers it is her brother, who is banished and becomes the Moon.\n\nVersion 2: Sese loves a great river serpent killed by her brother. She buries its pieces, and children are born from them, later forming two peoples."
    },
    fromager: {
      description: "A sacred and feared tree considered a dwelling place for spirits.",
      altName: "Mapou tree"
    },
    kwaze: {
      name: "Kwaze",
      altName: "Crossroads",
      description: "A meeting place between the world of the living and spirits."
    },
    kanari: {
      altName: "Clay jar",
      description: "The vessel where soukounyan stores her skin before flying."
    },
    "mezon-hante": {
      altName: "Haunted house",
      description: "Houses inhabited by spirits, often tied to old tragedies or buried treasures."
    },
    tchenn: {
      altName: "Chains",
      description: "The sound of dragging chains at night, sign of tormented spirits."
    },
    "je-dlo": {
      altName: "Ritual baths",
      description: "Purification with water and plants to protect from harm or remove curses."
    },
    "pye-bwa": {
      altName: "Inhabited trees",
      description: "Some trees are believed to be inhabited by spirits and are avoided at night."
    },
    "twou-mankoko": {
      altName: "Hell's Gate, Anse-Bertrand",
      description: "The abyss of Porte d'Enfer, considered one gateway to the underworld."
    }
  }
};

let currentLang = localStorage.getItem('folklore_lang') || 'fr';
if (!['fr', 'en'].includes(currentLang)) currentLang = 'fr';

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• HELPERS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function getAllEntries() {
  return [
    ...creatures.map(c => ({ ...c, type: 'creature' })),
    ...lieux.map(l => ({ ...l, symbol: l.icon, type: 'lieu' }))
  ];
}

function findCreature(id) { return creatures.find(c => c.id === id); }
function findLieu(id) { return lieux.find(l => l.id === id); }

function t(key) {
  return i18n[currentLang][key] ?? i18n.fr[key] ?? key;
}

function getEntryText(entry, key) {
  const localized = entryTranslations[currentLang]?.[entry.id]?.[key];
  if (localized === null) return null;
  return localized ?? entry[key];
}

function getLinkLabel(label) {
  return i18n[currentLang].linkLabels[label] || label;
}

function getCategoryLabel(cat) {
  return i18n[currentLang].categories[cat] || cat;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• RENDER CREATURE CARDS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const grid = document.getElementById('creatureGrid');
const mythGrid = document.getElementById('mythGrid');
let currentFilter = 'all';

function renderCards(filter = 'all') {
  const filtered = filter === 'all' ? creatureEntries : creatureEntries.filter(c => c.category === filter);
  grid.innerHTML = '';

  filtered.forEach((c) => {
    const card = document.createElement('div');
    card.className = 'card';
    card.dataset.creatureId = c.id;
    card.innerHTML = `
      <div class="card-image">${c.symbol}</div>
      <div class="card-content">
        <span class="card-tag">${getCategoryLabel(c.category)}</span>
        <h3 class="card-name">${getEntryText(c, 'name')}</h3>
        <p class="card-alt-name">${getEntryText(c, 'altName') || ''}</p>
        <p class="card-description">${getEntryText(c, 'description')}</p>
        <a class="card-link" href="javascript:void(0)">
          ${t('discover')} <span class="arrow">â†’</span>
        </a>
      </div>
    `;
    card.addEventListener('click', () => openModal(c, 'creature'));
    grid.appendChild(card);
  });

  updateCounter(filtered.length);
  observeCards(grid);
}

function renderMyths() {
  mythGrid.innerHTML = '';

  myths.forEach((m) => {
    const card = document.createElement('div');
    card.className = 'card';
    card.dataset.creatureId = m.id;
    card.innerHTML = `
      <div class="card-image">${m.symbol}</div>
      <div class="card-content">
        <span class="card-tag mythe">${getCategoryLabel(m.category)}</span>
        <h3 class="card-name">${getEntryText(m, 'name')}</h3>
        <p class="card-alt-name">${getEntryText(m, 'altName') || ''}</p>
        <p class="card-description">${getEntryText(m, 'description')}</p>
        <a class="card-link" href="javascript:void(0)">
          ${t('discover')} <span class="arrow">â†’</span>
        </a>
      </div>
    `;
    card.addEventListener('click', () => openModal(m, 'creature'));
    mythGrid.appendChild(card);
  });

  document.getElementById('mythCounter').textContent = `${myths.length} ${myths.length > 1 ? t('counterMythMany') : t('counterMythOne')}`;
  observeCards(mythGrid);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SCROLL REVEAL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const cardObservers = new Map();
function observeCards(container) {
  const existingObserver = cardObservers.get(container);
  if (existingObserver) existingObserver.disconnect();

  const observer = new IntersectionObserver((entries) => {
    const visible = entries.filter(e => e.isIntersecting);
    visible.forEach((entry, i) => {
      setTimeout(() => entry.target.classList.add('revealed'), i * 80);
      observer.unobserve(entry.target);
    });
  }, { threshold: 0.1, rootMargin: '0px 0px -40px 0px' });

  cardObservers.set(container, observer);
  container.querySelectorAll('.card').forEach(card => observer.observe(card));
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• RENDER LIEUX â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const lieuxGrid = document.getElementById('lieuxGrid');

function renderLieux() {
  lieuxGrid.innerHTML = '';
  lieux.forEach(l => {
    const card = document.createElement('div');
    card.className = 'lieu-card';
    card.dataset.lieuId = l.id;
    card.innerHTML = `
      <div class="lieu-icon">${l.icon}</div>
      <h3>${getEntryText(l, 'name')}</h3>
      <p class="lieu-alt">${getEntryText(l, 'altName') || ''}</p>
      <p>${getEntryText(l, 'description')}</p>
    `;
    card.addEventListener('click', () => openModal(l, 'lieu'));
    lieuxGrid.appendChild(card);
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• MODAL WITH CROSS-LINKS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const modal = document.getElementById('modal');
let activeModalData = null;
let activeModalType = null;

function openModal(data, type) {
  activeModalData = data;
  activeModalType = type;
  document.getElementById('modalSymbol').textContent = data.symbol || data.icon;
  const tag = document.getElementById('modalTag');
  tag.textContent = type === 'lieu' ? getCategoryLabel('lieu') : getCategoryLabel(data.category);
  tag.className = type === 'lieu' ? 'modal-tag lieu' : (data.category === 'mythe' ? 'modal-tag mythe' : 'modal-tag');
  document.getElementById('modalName').textContent = getEntryText(data, 'name');
  document.getElementById('modalAlt').textContent = getEntryText(data, 'altName') || '';
  document.getElementById('modalDesc').textContent = getEntryText(data, 'description');
  
  const storyEl = document.getElementById('modalStory');
  const storyText = getEntryText(data, 'story');
  if (storyText) {
    storyEl.textContent = storyText;
    storyEl.style.display = 'block';
  } else {
    storyEl.style.display = 'none';
  }
  
  // Cross-links
  const relationsEl = document.getElementById('modalRelations');
  relationsEl.innerHTML = '';
  
  const relatedCreatures = (data.relatedCreatures || []).map(id => findCreature(id)).filter(Boolean);
  const relatedLieux = (data.relatedLieux || []).map(id => findLieu(id)).filter(Boolean);
  
  if (relatedCreatures.length || relatedLieux.length) {
    const label = document.createElement('div');
    label.className = 'modal-relation-label';
    label.textContent = t('connections');
    relationsEl.appendChild(label);
    
    const tagsWrap = document.createElement('div');
    tagsWrap.className = 'modal-relations';
    
    relatedCreatures.forEach(rc => {
      const tag = document.createElement('a');
      tag.className = 'modal-relation-tag creature-link';
      tag.href = 'javascript:void(0)';
      tag.innerHTML = `${rc.symbol} ${getEntryText(rc, 'name')}`;
      tag.addEventListener('click', (e) => {
        e.preventDefault();
        openModal(rc, 'creature');
      });
      tagsWrap.appendChild(tag);
    });
    
    relatedLieux.forEach(rl => {
      const tag = document.createElement('a');
      tag.className = 'modal-relation-tag lieu-link';
      tag.href = 'javascript:void(0)';
      tag.innerHTML = `${rl.icon} ${getEntryText(rl, 'name')}`;
      tag.addEventListener('click', (e) => {
        e.preventDefault();
        openModal(rl, 'lieu');
      });
      tagsWrap.appendChild(tag);
    });
    
    relationsEl.appendChild(tagsWrap);
  }
  
  // Action links
  const linksEl = document.getElementById('modalLinks');
  linksEl.innerHTML = '';
  if (data.links && data.links.length) {
    data.links.forEach(l => {
      const a = document.createElement('a');
      a.className = 'modal-link';
      a.href = l.url;
      a.innerHTML = `${l.icon} ${getLinkLabel(l.label)}`;
      linksEl.appendChild(a);
    });
  }
  
  modal.classList.add('active');
  document.body.style.overflow = 'hidden';
}

document.getElementById('modalClose').addEventListener('click', (e) => {
  e.stopPropagation();
  closeModal();
});
modal.addEventListener('click', (e) => { if (e.target === modal) closeModal(); });
document.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeModal(); });

function closeModal() {
  modal.classList.remove('active');
  document.body.style.overflow = '';
  activeModalData = null;
  activeModalType = null;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• FILTERS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function applyLanguageUI() {
  document.documentElement.lang = currentLang;
  document.title = t('pageTitle');
  document.getElementById('heroTitle').innerHTML = t('heroTitle');
  document.getElementById('heroSubtitle').textContent = t('heroSubtitle');
  document.getElementById('scrollHint').childNodes[0].textContent = `${t('scrollHint')} `;
  document.getElementById('diceWrapper').title = t('diceTitle');
  document.getElementById('diceHintText').textContent = t('diceHintIdle');
  document.getElementById('chapterOneLabel').textContent = t('chapterOneLabel');
  document.getElementById('chapterOneTitle').textContent = t('chapterOneTitle');
  document.getElementById('chapterTwoLabel').textContent = t('chapterTwoLabel');
  document.getElementById('chapterTwoTitle').textContent = t('chapterTwoTitle');
  document.getElementById('chapterThreeLabel').textContent = t('chapterThreeLabel');
  document.getElementById('chapterThreeTitle').textContent = t('chapterThreeTitle');
  document.getElementById('footerCredit').innerHTML = t('footerCredit');
  document.getElementById('footerNote').textContent = t('footerNote');

  document.querySelector('[data-filter="all"]').textContent = t('filterAll');
  document.querySelector('[data-filter="esprit"]').textContent = t('filterEsprit');
  document.querySelector('[data-filter="creature"]').textContent = t('filterCreature');
  document.querySelector('[data-filter="sorcellerie"]').textContent = t('filterSorcellerie');
  document.querySelector('[data-filter="figure"]').textContent = t('filterFigure');

  document.getElementById('langToggle').setAttribute('aria-checked', currentLang === 'en' ? 'true' : 'false');
  document.getElementById('langFr').classList.toggle('active', currentLang === 'fr');
  document.getElementById('langEn').classList.toggle('active', currentLang === 'en');
}

function applyLanguage() {
  applyLanguageUI();
  renderCards(currentFilter);
  renderMyths();
  renderLieux();
  if (activeModalData && activeModalType) openModal(activeModalData, activeModalType);
}

document.querySelectorAll('.filter-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    document.querySelectorAll('.filter-btn').forEach(b => {
      b.classList.remove('active');
    });
    btn.classList.add('active');
    currentFilter = btn.dataset.filter;
    renderCards(currentFilter);
    grid.scrollIntoView({ behavior: 'smooth', block: 'start' });
  });
});

function updateCounter(total) {
  document.getElementById('gridCounter').textContent = `${total} ${total > 1 ? t('counterEntryMany') : t('counterEntryOne')}`;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• DICE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const diceCube = document.getElementById('diceCube');
const diceWrapper = document.getElementById('diceWrapper');
const diceResult = document.getElementById('diceResult');
const diceHint = document.getElementById('diceHintText');
let diceRolling = false;
let lastDiceResult = null;

// Put random emojis on dice faces
function updateDiceFaces() {
  const all = getAllEntries();
  const faces = diceCube.querySelectorAll('.dice-face');
  const shuffled = [...all].sort(() => Math.random() - 0.5);
  faces.forEach((face, i) => {
    face.textContent = shuffled[i % shuffled.length].symbol;
  });
}

updateDiceFaces();

diceWrapper.addEventListener('click', () => {
  if (diceRolling) return;
  diceRolling = true;
  
  // Hide previous result
  diceResult.classList.remove('visible');
  diceHint.textContent = '...';
  
  // Roll animation
  diceCube.classList.add('rolling');
  updateDiceFaces();
  
  // Pick random entry
  const all = getAllEntries();
  let pick;
  do {
    pick = all[Math.floor(Math.random() * all.length)];
  } while (lastDiceResult && pick.id === lastDiceResult.id && all.length > 1);
  lastDiceResult = pick;
  
  setTimeout(() => {
    diceCube.classList.remove('rolling');
    
    // Show result
    diceResult.textContent = `${pick.symbol} ${getEntryText(pick, 'name')}`;
    diceResult.classList.add('visible');
    diceHint.textContent = t('diceHintAfter');
    
    // Click result to open modal
    diceResult.onclick = () => {
      if (pick.type === 'lieu') {
        openModal(pick, 'lieu');
      } else {
        openModal(pick, 'creature');
      }
    };
    
    diceRolling = false;
  }, 1300);
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SCROLL-TO HELPER (for cross-links from modal) â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function scrollToCreature(id) {
  closeModal();
  // Reset filter to 'all' to ensure the card is visible
  document.querySelectorAll('.filter-btn').forEach(b => {
    b.classList.remove('active');
  });
  document.querySelector('[data-filter="all"]').classList.add('active');
  currentFilter = 'all';
  renderCards('all');

  setTimeout(() => {
    const card = grid.querySelector(`[data-creature-id="${id}"]`) ||
      mythGrid.querySelector(`[data-creature-id="${id}"]`);
    if (card) {
      card.classList.add('revealed');
      card.scrollIntoView({ behavior: 'smooth', block: 'center' });
      card.classList.add('highlighted');
      setTimeout(() => card.classList.remove('highlighted'), 3000);
    }
  }, 100);
}

function scrollToLieu(id) {
  closeModal();
  setTimeout(() => {
    const card = lieuxGrid.querySelector(`[data-lieu-id="${id}"]`);
    if (card) {
      card.scrollIntoView({ behavior: 'smooth', block: 'center' });
      card.classList.add('highlighted');
      setTimeout(() => card.classList.remove('highlighted'), 3000);
    }
  }, 100);
}

document.getElementById('langToggle').addEventListener('click', () => {
  currentLang = currentLang === 'fr' ? 'en' : 'fr';
  localStorage.setItem('folklore_lang', currentLang);
  applyLanguage();
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• INIT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
applyLanguage();
</script>
</body>
</html>
